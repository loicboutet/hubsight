<%= form_with(model: site, local: true) do |f| %>
  <% if site.errors.any? %>
    <div style="background-color: #fee; border: 1px solid #fcc; border-radius: 8px; padding: var(--space-md); margin-bottom: var(--space-lg);">
      <h3 style="color: #c33; margin: 0 0 var(--space-sm) 0; font-size: 1rem;">
        <%= pluralize(site.errors.count, "erreur") %> <%= site.errors.count > 1 ? "ont" : "a" %> empêché la sauvegarde :
      </h3>
      <ul style="margin: 0; padding-left: var(--space-lg);">
        <% site.errors.full_messages.each do |message| %>
          <li style="color: #c33;"><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div style="background-color: white; border-radius: var(--space-md); padding: var(--space-xl);">
    <!-- Basic Information Section -->
    <div style="margin-bottom: var(--space-xl);">
      <h3 class="typo-h3" style="margin-bottom: var(--space-lg); color: var(--coral-primary); border-bottom: 2px solid var(--pink-pale); padding-bottom: var(--space-sm);">
        Informations de base
      </h3>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); margin-bottom: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Nom du site <span style="color: #dc2626;">*</span>
          </label>
          <%= f.text_field :name, required: true, placeholder: "Ex: Centre Commercial Odysseum", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Code/Référence
          </label>
          <%= f.text_field :code, placeholder: "Ex: CCO-001", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); margin-bottom: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Type de site <span style="color: #dc2626;">*</span>
          </label>
          <%= f.select :site_type, 
              options_for_select(Site::SITE_TYPES.map { |k, v| [v, k] }, site.site_type),
              { include_blank: "Sélectionner un type" },
              { required: true, style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;" } %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Statut <span style="color: #dc2626;">*</span>
          </label>
          <%= f.select :status,
              options_for_select(Site::STATUSES.map { |k, v| [v, k] }, site.status),
              {},
              { required: true, style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;" } %>
        </div>
      </div>

      <div>
        <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
          Description
        </label>
        <%= f.text_area :description, rows: 3, placeholder: "Description du site...", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); resize: vertical;" %>
      </div>
    </div>

    <!-- Location Information Section -->
    <div style="margin-bottom: var(--space-xl);">
      <h3 class="typo-h3" style="margin-bottom: var(--space-lg); color: var(--coral-primary); border-bottom: 2px solid var(--pink-pale); padding-bottom: var(--space-sm);">
        Localisation
      </h3>
      
      <div style="margin-bottom: var(--space-lg);">
        <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
          Adresse complète <span style="color: #dc2626;">*</span>
        </label>
        <%= f.text_field :address, required: true, placeholder: "Ex: 2 Place de Lisbonne", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
      </div>

      <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: var(--space-lg); margin-bottom: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Ville <span style="color: #dc2626;">*</span>
          </label>
          <%= f.text_field :city, required: true, placeholder: "Ex: Montpellier", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Code postal <span style="color: #dc2626;">*</span>
          </label>
          <%= f.text_field :postal_code, required: true, pattern: "\\d{5}", placeholder: "Ex: 34000", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Département
          </label>
          <%= f.text_field :department, placeholder: "Ex: 34", maxlength: 3, style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Région
          </label>
          <%= f.select :region,
              options_for_select(Site::REGIONS.map { |k, v| [v, k] }, site.region),
              { include_blank: "Sélectionner une région" },
              { style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;" } %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Pays
          </label>
          <%= f.text_field :country, placeholder: "France", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>
    </div>

    <!-- Area Metrics Section -->
    <div style="margin-bottom: var(--space-xl);">
      <h3 class="typo-h3" style="margin-bottom: var(--space-lg); color: var(--coral-primary); border-bottom: 2px solid var(--pink-pale); padding-bottom: var(--space-sm);">
        Surfaces
      </h3>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Surface totale (m²)
          </label>
          <%= f.number_field :total_area, step: 0.01, min: 0, placeholder: "Ex: 65000", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Surface estimée (m²)
          </label>
          <%= f.number_field :estimated_area, step: 0.01, min: 0, placeholder: "Ex: 68000", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>
    </div>

    <!-- Contact Information Section -->
    <div style="margin-bottom: var(--space-xl);">
      <h3 class="typo-h3" style="margin-bottom: var(--space-lg); color: var(--coral-primary); border-bottom: 2px solid var(--pink-pale); padding-bottom: var(--space-sm);">
        Contact
      </h3>
      
      <div style="margin-bottom: var(--space-lg);">
        <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
          Responsable de site
        </label>
        <%= f.text_field :site_manager, placeholder: "Ex: Marie Dubois", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Email de contact
          </label>
          <%= f.email_field :contact_email, placeholder: "Ex: contact@odysseum.fr", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Téléphone de contact
          </label>
          <%= f.telephone_field :contact_phone, placeholder: "Ex: +33 4 67 13 50 00", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>
    </div>

    <!-- Technical Information Section -->
    <div style="margin-bottom: var(--space-xl);">
      <h3 class="typo-h3" style="margin-bottom: var(--space-lg); color: var(--coral-primary); border-bottom: 2px solid var(--pink-pale); padding-bottom: var(--space-sm);">
        Informations techniques (optionnel)
      </h3>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); margin-bottom: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Coordonnées GPS
          </label>
          <%= f.text_field :gps_coordinates, placeholder: "Ex: 43.6055° N, 3.9197° E", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Zone climatique
          </label>
          <%= f.text_field :climate_zone, placeholder: "Ex: H3 - Zone méditerranéenne", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            Référence cadastrale
          </label>
          <%= f.text_field :cadastral_id, placeholder: "Ex: 34000-001-AB-1234", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
        
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">
            ID RNB
          </label>
          <%= f.text_field :rnb_id, placeholder: "Ex: RNB-34-MTL-001", style: "width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);" %>
        </div>
      </div>
    </div>

    <!-- Form Actions -->
    <div style="display: flex; gap: var(--space-md); justify-content: flex-end; border-top: 1px solid var(--light-gray); padding-top: var(--space-lg);">
      <%= link_to "Annuler", sites_path, class: "typo-btn-cancel" %>
      <%= f.submit site.new_record? ? "Créer le site" : "Mettre à jour le site", class: "typo-btn-success" %>
    </div>
  </div>
<% end %>
