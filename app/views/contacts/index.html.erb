<% content_for :header, "Contacts" %>

<div class="section">
  <% if @organization.present? %>
    <!-- NESTED VIEW: Contacts for a specific organization -->
    <div class="page-header-responsive">
      <div>
        <h2 class="typo-h2" style="margin-bottom: var(--space-sm);">Contacts de <%= @organization.name %></h2>
        <p class="typo-body-small">Gérer les contacts de cette organisation</p>
      </div>
      <a href="<%= new_organization_contact_path(@organization) %>" class="typo-btn-success" style="display: inline-flex; align-items: center; gap: var(--space-sm);">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
        Nouveau Contact
      </a>
    </div>

    <div style="background-color: var(--white); border-radius: var(--space-md); ">
      <!-- Filters Section -->
      <div style="margin-bottom: var(--space-xl); padding: var(--space-lg); background-color: #f8f9fa; border-radius: var(--space-sm);">
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md);">
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Recherche</label>
            <input type="text" placeholder="Nom, poste, email..." style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);">
          </div>
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Trier par</label>
            <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
              <option>Nom (A-Z)</option>
              <option>Poste</option>
              <option>Récemment ajouté</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Contacts Grid -->
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg);">
        <% [
          {id: 1, first_name: "Marie", last_name: "Dubois", position: "Directrice Technique", email: "m.dubois@entreprise.fr", phone: "+33 1 23 45 67 89", mobile: "+33 6 12 34 56 78", available: true},
          {id: 2, first_name: "Jean", last_name: "Martin", position: "Responsable Maintenance", email: "j.martin@entreprise.fr", phone: "+33 1 23 45 67 90", mobile: "+33 6 98 76 54 32", available: true},
          {id: 3, first_name: "Sophie", last_name: "Bernard", position: "Chef de Projet", email: "s.bernard@entreprise.fr", phone: "+33 1 23 45 67 91", mobile: "+33 6 11 22 33 44", available: false},
          {id: 4, first_name: "Pierre", last_name: "Lefebvre", position: "Technicien Senior", email: "p.lefebvre@entreprise.fr", phone: "+33 1 23 45 67 92", mobile: "+33 6 55 66 77 88", available: true},
          {id: 5, first_name: "Anne", last_name: "Moreau", position: "Responsable Sécurité", email: "a.moreau@entreprise.fr", phone: "+33 1 23 45 67 93", mobile: "+33 6 99 88 77 66", available: true},
          {id: 6, first_name: "Thomas", last_name: "Petit", position: "Ingénieur CVC", email: "t.petit@entreprise.fr", phone: "+33 1 23 45 67 94", mobile: "+33 6 44 33 22 11", available: false},
        ].each do |contact| %>
          <div style="border: 1px solid var(--light-gray); border-radius: var(--space-md); overflow: hidden; transition: box-shadow 0.3s;">
            <!-- Contact Header -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: var(--space-lg); color: white; display: flex; align-items: center; gap: var(--space-md);">
              <div style="width: 64px; height: 64px; border-radius: 50%; background-color: rgba(255,255,255,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.5rem; flex-shrink: 0;">
                <%= contact[:first_name][0] %><%= contact[:last_name][0] %>
              </div>
              <div style="flex: 1; min-width: 0;">
                <h4 class="typo-h4" style="color: white; margin-bottom: var(--space-xs); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                  <%= contact[:first_name] %> <%= contact[:last_name] %>
                </h4>
                <p class="typo-body-small" style="color: rgba(255,255,255,0.9); font-size: 0.85rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                  <%= contact[:position] %>
                </p>
              </div>
            </div>
            
            <!-- Contact Details -->
            <div style="padding: var(--space-lg);">
              <div style="margin-bottom: var(--space-lg);">
                <div style="margin-bottom: var(--space-md);">
                  <p class="typo-body-small" style="color: #999; font-size: 0.7rem; margin-bottom: var(--space-xs);">EMAIL</p>
                  <a href="mailto:<%= contact[:email] %>" class="typo-body-small" style="color: var(--coral-primary); text-decoration: none; word-break: break-all;">
                    <%= contact[:email] %>
                  </a>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md);">
                  <div>
                    <p class="typo-body-small" style="color: #999; font-size: 0.7rem; margin-bottom: var(--space-xs);">FIXE</p>
                    <a href="tel:<%= contact[:phone] %>" class="typo-body-small" style="color: var(--dark-gray); text-decoration: none;">
                      <%= contact[:phone] %>
                    </a>
                  </div>
                  <div>
                    <p class="typo-body-small" style="color: #999; font-size: 0.7rem; margin-bottom: var(--space-xs);">MOBILE</p>
                    <a href="tel:<%= contact[:mobile] %>" class="typo-body-small" style="color: var(--dark-gray); text-decoration: none;">
                      <%= contact[:mobile] %>
                    </a>
                  </div>
                </div>
              </div>

              <div style="display: flex; gap: var(--space-xs); margin-bottom: var(--space-lg);">
                <% if contact[:available] %>
                  <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; background-color: #d4edda; color: #155724; border-radius: 10px; font-size: 0.7rem; font-weight: 600;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                      <circle cx="8" cy="8" r="6" fill="currentColor"/>
                    </svg>
                    Disponible
                  </span>
                <% else %>
                  <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; background-color: #f8d7da; color: #721c24; border-radius: 10px; font-size: 0.7rem; font-weight: 600;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                      <circle cx="8" cy="8" r="6" fill="currentColor"/>
                    </svg>
                    Indisponible
                  </span>
                <% end %>
              </div>
              
              <div style="display: flex; gap: var(--space-xs); justify-content: center;">
                <%= link_to contact_path(contact[:id]), title: "Voir", class: "typo-btn-small typo-btn-small-secondary" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                  </svg>
                  Voir
                <% end %>
                <%= link_to edit_contact_path(contact[:id]), title: "Éditer", class: "typo-btn-small typo-btn-small-primary" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                  </svg>
                  Éditer
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Pagination -->
      <div style="margin-top: var(--space-xl);">
        <%= render 'shared/pagination', 
          current_page: 1, 
          total_pages: 1, 
          total_count: 6, 
          per_page: 10,
          path: organization_contacts_path(@organization) %>
      </div>
    </div>

  <% else %>
    <!-- STANDALONE VIEW: All contacts from all organizations -->
    <div class="page-header-responsive">
      <div>
        <h2 class="typo-h2" style="margin-bottom: var(--space-sm);">Gestion des Contacts</h2>
        <p class="typo-body-small">Gérer tous les contacts de toutes les organisations</p>
      </div>
      <a href="<%= new_contact_path %>" class="typo-btn-success" style="display: inline-flex; align-items: center; gap: var(--space-sm);">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
        Nouveau Contact
      </a>
    </div>

    <div style="background-color: var(--white); border-radius: var(--space-md); ">
      <!-- Filters Section -->
      <div style="margin-bottom: var(--space-xl); padding: var(--space-lg); background-color: #f8f9fa; border-radius: var(--space-sm);">
        <style>
          @media (max-width: 1400px) {
            .filters-grid-contacts { grid-template-columns: 1fr 1fr 1fr auto auto !important; }
          }
          @media (max-width: 1200px) {
            .filters-grid-contacts { grid-template-columns: 1fr 1fr auto auto !important; }
          }
          @media (max-width: 768px) {
            .filters-grid-contacts { grid-template-columns: 1fr !important; }
          }
        </style>
        <div class="filters-grid-contacts" style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr 1fr auto auto; gap: var(--space-md); align-items: end;">
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Recherche</label>
            <input type="text" placeholder="Nom, email, téléphone..." style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);">
          </div>
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Organisation</label>
            <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
              <option>Toutes</option>
              <option>ENGIE Solutions</option>
              <option>OTIS France</option>
              <option>Daikin Service</option>
              <option>Bouygues Energies</option>
            </select>
          </div>
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Fonction</label>
            <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
              <option>Toutes</option>
              <option>Directeur</option>
              <option>Responsable</option>
              <option>Technicien</option>
              <option>Ingénieur</option>
            </select>
          </div>
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Catégorie du contact</label>
            <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
              <option>Toutes</option>
              <option>Comptabilité</option>
              <option>Technique</option>
              <option>Exploitation</option>
              <option>Commercial</option>
            </select>
          </div>
          <div>
            <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Disponibilité</label>
            <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
              <option>Tous</option>
              <option>Disponible</option>
              <option>Indisponible</option>
            </select>
          </div>
          <button type="button" class="typo-btn-cancel" style="display: inline-flex; align-items: center; gap: var(--space-sm);">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
            Effacer
          </button>
          <button type="submit" class="typo-btn-success" style="display: inline-flex; align-items: center; gap: var(--space-sm);">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
            </svg>
            Filtrer
          </button>
        </div>
      </div>

      <!-- Contacts Table -->
      <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="background-color: #f8f9fa; border-bottom: 2px solid var(--pink-pale);">
              <th style="padding: var(--space-md); text-align: left; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">CONTACT</th>
              <th style="padding: var(--space-md); text-align: left; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">ORGANISATION</th>
              <th style="padding: var(--space-md); text-align: left; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">FONCTION</th>
              <th style="padding: var(--space-md); text-align: left; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">CATÉGORIE</th>
              <th style="padding: var(--space-md); text-align: left; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">COORDONNÉES</th>
              <th style="padding: var(--space-md); text-align: center; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">STATUT</th>
              <th style="padding: var(--space-md); text-align: right; font-weight: 600; color: var(--gray-secondary); font-size: 0.875rem;">ACTIONS</th>
            </tr>
          </thead>
          <tbody>
            <% [
              {id: 1, first_name: "Marie", last_name: "Dubois", organization: "ENGIE Solutions", position: "Directrice Technique", category: "Technique", email: "m.dubois@engie.com", phone: "+33 1 40 06 20 01", mobile: "+33 6 12 34 56 78", available: true},
              {id: 2, first_name: "Jean", last_name: "Martin", organization: "OTIS France", position: "Responsable Maintenance", category: "Technique", email: "j.martin@otis.com", phone: "+33 1 55 47 80 01", mobile: "+33 6 98 76 54 32", available: true},
              {id: 3, first_name: "Sophie", last_name: "Bernard", organization: "Daikin Service", position: "Chef de Projet CVC", category: "Exploitation", email: "s.bernard@daikin.fr", phone: "+33 1 45 16 27 28", mobile: "+33 6 11 22 33 44", available: false},
              {id: 4, first_name: "Pierre", last_name: "Lefebvre", organization: "Bouygues Energies & Services", position: "Technicien Senior", category: "Technique", email: "p.lefebvre@bouygues-es.com", phone: "+33 1 30 60 33 01", mobile: "+33 6 55 66 77 88", available: true},
              {id: 5, first_name: "Anne", last_name: "Moreau", organization: "Clean Pro Services", position: "Responsable Sécurité", category: "Exploitation", email: "a.moreau@cleanpro.fr", phone: "+33 1 42 35 78 91", mobile: "+33 6 99 88 77 66", available: true},
              {id: 6, first_name: "Thomas", last_name: "Petit", organization: "Bureau Veritas", position: "Ingénieur Contrôle", category: "Technique", email: "t.petit@bureauveritas.com", phone: "+33 1 45 17 70 01", mobile: "+33 6 44 33 22 11", available: false},
              {id: 7, first_name: "Caroline", last_name: "Dupont", organization: "Schindler France", position: "Responsable Technique", category: "Technique", email: "c.dupont@schindler.fr", phone: "+33 1 41 02 52 01", mobile: "+33 6 77 88 99 00", available: true},
              {id: 8, first_name: "Laurent", last_name: "Rousseau", organization: "Veolia Propreté", position: "Chef d'Équipe", category: "Exploitation", email: "l.rousseau@veolia.com", phone: "+33 1 71 75 00 01", mobile: "+33 6 22 33 44 55", available: true},
              {id: 9, first_name: "Isabelle", last_name: "Garnier", organization: "EDF Entreprises", position: "Conseiller Énergie", category: "Commercial", email: "i.garnier@edf.fr", phone: "+33 1 40 42 22 23", mobile: "+33 6 88 99 00 11", available: true},
              {id: 10, first_name: "Michel", last_name: "Fontaine", organization: "Securitas France", position: "Responsable Sécurité", category: "Exploitation", email: "m.fontaine@securitas.fr", phone: "+33 1 55 07 41 01", mobile: "+33 6 33 44 55 66", available: false},
              {id: 11, first_name: "Nathalie", last_name: "Legrand", organization: "Vert Nature SARL", position: "Responsable Espaces Verts", category: "Exploitation", email: "n.legrand@vertnature.fr", phone: "+33 1 48 56 32 11", mobile: "+33 6 11 00 99 88", available: true},
              {id: 12, first_name: "Philippe", last_name: "Marchand", organization: "Climatic Services", position: "Ingénieur Frigoriste", category: "Technique", email: "p.marchand@climatic.fr", phone: "+33 1 39 74 82 01", mobile: "+33 6 66 77 88 99", available: true},
            ].each_with_index do |contact, index| %>
              <tr style="border-bottom: 1px solid #e9ecef; <%= 'background-color: #fafbfc;' if index.even? %>">
                <!-- Contact Name -->
                <td style="padding: var(--space-md);">
                  <div style="display: flex; align-items: center; gap: var(--space-md);">
                    <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 0.875rem; flex-shrink: 0;">
                      <%= contact[:first_name][0] %><%= contact[:last_name][0] %>
                    </div>
                    <div>
                      <%= link_to contact_path(contact[:id]), style: "text-decoration: none;" do %>
                        <p class="typo-body-small typo-bold" style="margin-bottom: 2px; color: var(--coral-primary);">
                          <%= contact[:first_name] %> <%= contact[:last_name] %>
                        </p>
                      <% end %>
                    </div>
                  </div>
                </td>
                
                <!-- Organization -->
                <td style="padding: var(--space-md);">
                  <p class="typo-body-small" style="color: #666;"><%= contact[:organization] %></p>
                </td>
                
                <!-- Position -->
                <td style="padding: var(--space-md);">
                  <span style="display: inline-block; padding: 4px 12px; background-color: #e7f3ff; color: #0066cc; border-radius: 12px; font-size: 0.813rem; font-weight: 600;">
                    <%= contact[:position] %>
                  </span>
                </td>
                
                <!-- Category -->
                <td style="padding: var(--space-md);">
                  <% 
                    category_styles = {
                      "Comptabilité" => "background-color: #fff3cd; color: #856404;",
                      "Technique" => "background-color: #d4edda; color: #155724;",
                      "Exploitation" => "background-color: #f8d7da; color: #721c24;",
                      "Commercial" => "background-color: #e7d3f7; color: #5a1a7a;"
                    }
                    style = category_styles[contact[:category]] || "background-color: #e9ecef; color: #495057;"
                  %>
                  <span style="display: inline-block; padding: 4px 12px; <%= style %> border-radius: 12px; font-size: 0.813rem; font-weight: 600;">
                    <%= contact[:category] %>
                  </span>
                </td>
                
                <!-- Contact Info -->
                <td style="padding: var(--space-md);">
                  <div>
                    <p class="typo-body-small" style="margin-bottom: 4px; font-size: 0.813rem;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                      </svg>
                      <%= contact[:email] %>
                    </p>
                    <p class="typo-body-small" style="color: #999; font-size: 0.75rem;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                      </svg>
                      <%= contact[:mobile] %>
                    </p>
                  </div>
                </td>
                
                <!-- Status -->
                <td style="padding: var(--space-md); text-align: center;">
                  <% if contact[:available] %>
                    <span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; background-color: #d4edda; color: #155724; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" fill="currentColor" viewBox="0 0 16 16">
                        <circle cx="8" cy="8" r="8" fill="currentColor"/>
                      </svg>
                      Disponible
                    </span>
                  <% else %>
                    <span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; background-color: #f8d7da; color: #721c24; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" fill="currentColor" viewBox="0 0 16 16">
                        <circle cx="8" cy="8" r="8" fill="currentColor"/>
                      </svg>
                      Indisponible
                    </span>
                  <% end %>
                </td>
                
                <!-- Actions -->
                <td style="padding: var(--space-md);">
                  <div style="display: flex; gap: var(--space-xs); justify-content: flex-end;">
                    <%= link_to contact_path(contact[:id]), class: "typo-btn-small typo-btn-small-secondary" do %>
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                      </svg>
                      Voir
                    <% end %>
                  <%= link_to edit_contact_path(contact[:id]), class: "typo-btn-small typo-btn-small-primary" do %>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                    Modifier
                  <% end %>
                  <button type="button" 
                    data-action="open-delete-modal" 
                    data-modal-id="deletion-modal-contact-<%= contact[:id] %>"
                    title="Supprimer"
                    class="typo-btn-small"
                    style="background-color: #dc2626; color: white; border: none; cursor: pointer; display: inline-flex; align-items: center; gap: 4px; padding: 6px 10px; border-radius: 6px; font-size: 0.813rem; font-weight: 600; transition: background-color 0.2s;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                    Supprimer
                  </button>
                </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div style="margin-top: var(--space-xl);">
        <%= render 'shared/pagination', 
          current_page: 1, 
          total_pages: 1, 
          total_count: 12, 
          per_page: 15,
          path: contacts_path %>
      </div>
    </div>
  <% end %>
  
  <!-- Deletion Confirmation Modals -->
  <% [
    {id: 1, first_name: "Marie", last_name: "Dubois", organization: "ENGIE Solutions", position: "Directrice Technique", category: "Technique", email: "m.dubois@engie.com", phone: "+33 1 40 06 20 01", mobile: "+33 6 12 34 56 78", available: true},
    {id: 2, first_name: "Jean", last_name: "Martin", organization: "OTIS France", position: "Responsable Maintenance", category: "Technique", email: "j.martin@otis.com", phone: "+33 1 55 47 80 01", mobile: "+33 6 98 76 54 32", available: true},
    {id: 3, first_name: "Sophie", last_name: "Bernard", organization: "Daikin Service", position: "Chef de Projet CVC", category: "Exploitation", email: "s.bernard@daikin.fr", phone: "+33 1 45 16 27 28", mobile: "+33 6 11 22 33 44", available: false},
    {id: 4, first_name: "Pierre", last_name: "Lefebvre", organization: "Bouygues Energies & Services", position: "Technicien Senior", category: "Technique", email: "p.lefebvre@bouygues-es.com", phone: "+33 1 30 60 33 01", mobile: "+33 6 55 66 77 88", available: true},
    {id: 5, first_name: "Anne", last_name: "Moreau", organization: "Clean Pro Services", position: "Responsable Sécurité", category: "Exploitation", email: "a.moreau@cleanpro.fr", phone: "+33 1 42 35 78 91", mobile: "+33 6 99 88 77 66", available: true},
    {id: 6, first_name: "Thomas", last_name: "Petit", organization: "Bureau Veritas", position: "Ingénieur Contrôle", category: "Technique", email: "t.petit@bureauveritas.com", phone: "+33 1 45 17 70 01", mobile: "+33 6 44 33 22 11", available: false},
    {id: 7, first_name: "Caroline", last_name: "Dupont", organization: "Schindler France", position: "Responsable Technique", category: "Technique", email: "c.dupont@schindler.fr", phone: "+33 1 41 02 52 01", mobile: "+33 6 77 88 99 00", available: true},
    {id: 8, first_name: "Laurent", last_name: "Rousseau", organization: "Veolia Propreté", position: "Chef d'Équipe", category: "Exploitation", email: "l.rousseau@veolia.com", phone: "+33 1 71 75 00 01", mobile: "+33 6 22 33 44 55", available: true},
    {id: 9, first_name: "Isabelle", last_name: "Garnier", organization: "EDF Entreprises", position: "Conseiller Énergie", category: "Commercial", email: "i.garnier@edf.fr", phone: "+33 1 40 42 22 23", mobile: "+33 6 88 99 00 11", available: true},
    {id: 10, first_name: "Michel", last_name: "Fontaine", organization: "Securitas France", position: "Responsable Sécurité", category: "Exploitation", email: "m.fontaine@securitas.fr", phone: "+33 1 55 07 41 01", mobile: "+33 6 33 44 55 66", available: false},
    {id: 11, first_name: "Nathalie", last_name: "Legrand", organization: "Vert Nature SARL", position: "Responsable Espaces Verts", category: "Exploitation", email: "n.legrand@vertnature.fr", phone: "+33 1 48 56 32 11", mobile: "+33 6 11 00 99 88", available: true},
    {id: 12, first_name: "Philippe", last_name: "Marchand", organization: "Climatic Services", position: "Ingénieur Frigoriste", category: "Technique", email: "p.marchand@climatic.fr", phone: "+33 1 39 74 82 01", mobile: "+33 6 66 77 88 99", available: true},
  ].each do |contact| %>
    <%= render 'shared/deletion_confirmation_modal',
      entity_type: 'le contact',
      entity_name: "#{contact[:first_name]} #{contact[:last_name]} - #{contact[:position]}",
      entity_id: "contact-#{contact[:id]}",
      affected_items: {},
      requires_extra_confirmation: false,
      delete_path: contact_path(contact[:id])
    %>
  <% end %>
</div>

<!-- Initialize deletion confirmation controller -->
<div data-controller="deletion-confirmation"></div>
