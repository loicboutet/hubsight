<% content_for :header, "Contacts" %>

<div class="section">
  <div style="margin-bottom: var(--space-xl); display: flex; justify-content: space-between; align-items: center;">
    <div>
      <h2 class="typo-h2" style="margin-bottom: var(--space-sm);">Contacts de l'Organisation</h2>
      <p class="typo-body-small">Gérer les contacts de cette organisation</p>
    </div>
    <a href="<%= new_organization_contact_path(@organization) %>" class="typo-btn-success" style="display: inline-flex; align-items: center; gap: var(--space-sm);">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
      </svg>
      Nouveau Contact
    </a>
  </div>

  <div style="background-color: var(--white); border-radius: var(--space-md); ">
    <!-- Filters Section -->
    <div style="margin-bottom: var(--space-xl); padding: var(--space-lg); background-color: #f8f9fa; border-radius: var(--space-sm);">
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Recherche</label>
          <input type="text" placeholder="Nom, poste, email..." style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);">
        </div>
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Trier par</label>
          <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm);">
            <option>Nom (A-Z)</option>
            <option>Poste</option>
            <option>Récemment ajouté</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Contacts Grid -->
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg);">
      <% [
        {id: 1, first_name: "Marie", last_name: "Dubois", position: "Directrice Technique", email: "m.dubois@entreprise.fr", phone: "+33 1 23 45 67 89", mobile: "+33 6 12 34 56 78", available: true},
        {id: 2, first_name: "Jean", last_name: "Martin", position: "Responsable Maintenance", email: "j.martin@entreprise.fr", phone: "+33 1 23 45 67 90", mobile: "+33 6 98 76 54 32", available: true},
        {id: 3, first_name: "Sophie", last_name: "Bernard", position: "Chef de Projet", email: "s.bernard@entreprise.fr", phone: "+33 1 23 45 67 91", mobile: "+33 6 11 22 33 44", available: false},
        {id: 4, first_name: "Pierre", last_name: "Lefebvre", position: "Technicien Senior", email: "p.lefebvre@entreprise.fr", phone: "+33 1 23 45 67 92", mobile: "+33 6 55 66 77 88", available: true},
        {id: 5, first_name: "Anne", last_name: "Moreau", position: "Responsable Sécurité", email: "a.moreau@entreprise.fr", phone: "+33 1 23 45 67 93", mobile: "+33 6 99 88 77 66", available: true},
        {id: 6, first_name: "Thomas", last_name: "Petit", position: "Ingénieur CVC", email: "t.petit@entreprise.fr", phone: "+33 1 23 45 67 94", mobile: "+33 6 44 33 22 11", available: false},
      ].each do |contact| %>
        <div style="border: 1px solid var(--light-gray); border-radius: var(--space-md); overflow: hidden; transition: box-shadow 0.3s;">
          <!-- Contact Header -->
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: var(--space-lg); color: white; display: flex; align-items: center; gap: var(--space-md);">
            <div style="width: 64px; height: 64px; border-radius: 50%; background-color: rgba(255,255,255,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.5rem; flex-shrink: 0;">
              <%= contact[:first_name][0] %><%= contact[:last_name][0] %>
            </div>
            <div style="flex: 1; min-width: 0;">
              <h4 class="typo-h4" style="color: white; margin-bottom: var(--space-xs); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                <%= contact[:first_name] %> <%= contact[:last_name] %>
              </h4>
              <p class="typo-body-small" style="color: rgba(255,255,255,0.9); font-size: 0.85rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                <%= contact[:position] %>
              </p>
            </div>
          </div>
          
          <!-- Contact Details -->
          <div style="padding: var(--space-lg);">
            <div style="margin-bottom: var(--space-lg);">
              <div style="margin-bottom: var(--space-md);">
                <p class="typo-body-small" style="color: #999; font-size: 0.7rem; margin-bottom: var(--space-xs);">EMAIL</p>
                <a href="mailto:<%= contact[:email] %>" class="typo-body-small" style="color: var(--coral-primary); text-decoration: none; word-break: break-all;">
                  <%= contact[:email] %>
                </a>
              </div>
              
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-md);">
                <div>
                  <p class="typo-body-small" style="color: #999; font-size: 0.7rem; margin-bottom: var(--space-xs);">FIXE</p>
                  <a href="tel:<%= contact[:phone] %>" class="typo-body-small" style="color: var(--dark-gray); text-decoration: none;">
                    <%= contact[:phone] %>
                  </a>
                </div>
                <div>
                  <p class="typo-body-small" style="color: #999; font-size: 0.7rem; margin-bottom: var(--space-xs);">MOBILE</p>
                  <a href="tel:<%= contact[:mobile] %>" class="typo-body-small" style="color: var(--dark-gray); text-decoration: none;">
                    <%= contact[:mobile] %>
                  </a>
                </div>
              </div>
            </div>

            <div style="display: flex; gap: var(--space-xs); margin-bottom: var(--space-lg);">
              <% if contact[:available] %>
                <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; background-color: #d4edda; color: #155724; border-radius: 10px; font-size: 0.7rem; font-weight: 600;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                    <circle cx="8" cy="8" r="6" fill="currentColor"/>
                  </svg>
                  Disponible
                </span>
              <% else %>
                <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; background-color: #f8d7da; color: #721c24; border-radius: 10px; font-size: 0.7rem; font-weight: 600;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                    <circle cx="8" cy="8" r="6" fill="currentColor"/>
                  </svg>
                  Indisponible
                </span>
              <% end %>
            </div>
            
            <div style="display: flex; gap: var(--space-xs); justify-content: center;">
              <%= link_to contact_path(contact[:id]), title: "Voir", class: "typo-btn-small typo-btn-small-secondary" do %>
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
                Voir
              <% end %>
              <%= link_to edit_contact_path(contact[:id]), title: "Éditer", class: "typo-btn-small typo-btn-small-primary" do %>
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
                Éditer
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Pagination -->
    <div style="margin-top: var(--space-xl);">
      <%= render 'shared/pagination', 
        current_page: 1, 
        total_pages: 1, 
        total_count: 6, 
        per_page: 10,
        path: organization_contacts_path(@organization) %>
    </div>
  </div>
</div>
