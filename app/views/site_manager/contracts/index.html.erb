<% content_for :header, "Mes Contrats" %>

<div class="section">
  <div style="margin-bottom: var(--space-xl); display: flex; justify-content: space-between; align-items: center;">
    <div>
      <h2 class="typo-h2" style="margin-bottom: var(--space-sm);">Mes Contrats</h2>
      <p class="typo-body-small">Contrats liés à vos sites assignés - Consultation et upload uniquement</p>
    </div>
    <a href="<%= my_contracts_upload_path %>" class="typo-btn-success" style="display: inline-flex; align-items: center; gap: var(--space-sm);">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
      </svg>
      Upload Contrat
    </a>
  </div>

  <div style="background-color: var(--white); border-radius: var(--space-md); ">
    <!-- Filters -->
    <div style="margin-bottom: var(--space-xl); padding: var(--space-lg); background-color: #f8f9fa; border-radius: var(--space-sm);">
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-md);">
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Site</label>
          <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
            <option>Tous mes sites</option>
            <option>Tour Montparnasse</option>
            <option>Campus La Défense</option>
          </select>
        </div>
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Famille</label>
          <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
            <option>Toutes</option>
            <option>Maintenance</option>
            <option>Nettoyage</option>
          </select>
        </div>
        <div>
          <label class="typo-body-small typo-bold" style="display: block; margin-bottom: var(--space-sm);">Statut</label>
          <select style="width: 100%; padding: 10px; border: 1px solid var(--light-gray); border-radius: var(--space-sm); background-color: white;">
            <option>Tous</option>
            <option>Actif</option>
            <option>Terminé</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Contracts List -->
    <div style="display: grid; gap: var(--space-md);">
      <% [
        {number: "CTR-2025-001", title: "Maintenance ascenseurs", provider: "OTIS France", site: "Tour Montparnasse", amount: "24,500 €", status: "Actif"},
        {number: "CTR-2025-002", title: "Nettoyage bureaux", provider: "Clean Pro", site: "Campus La Défense", amount: "12,800 €", status: "Actif"},
        {number: "CTR-2024-189", title: "Contrôle électrique", provider: "Bureau Veritas", site: "Tour Montparnasse", amount: "8,500 €", status: "Terminé"},
        {number: "CTR-2025-003", title: "CVC Maintenance", provider: "Daikin Service", site: "Campus La Défense", amount: "31,200 €", status: "Actif"},
        {number: "CTR-2024-188", title: "Espaces verts", provider: "Vert Nature", site: "Résidence Le Parc", amount: "6,400 €", status: "Actif"}
      ].each do |contract| %>
        <div style="border: 1px solid var(--light-gray); border-radius: var(--space-sm); padding: var(--space-lg);">
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
              <p class="typo-body-small typo-bold" style="color: var(--coral-primary); margin-bottom: var(--space-xs);"><%= contract[:number] %></p>
              <h4 class="typo-h4" style="margin-bottom: var(--space-xs);"><%= contract[:title] %></h4>
              <p class="typo-body-small" style="color: #999; margin-bottom: var(--space-sm);"><%= contract[:provider] %></p>
              <p class="typo-body-small" style="color: #666;"><strong>Site:</strong> <%= contract[:site] %></p>
            </div>
            <div style="text-align: right;">
              <p class="typo-body-small typo-bold" style="font-size: 1.1rem; margin-bottom: var(--space-sm);"><%= contract[:amount] %></p>
              <span style="display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; <%= contract[:status] == 'Actif' ? 'background-color: #d4edda; color: #155724;' : 'background-color: #e2e8f0; color: #4a5568;' %>">
                <%= contract[:status] %>
              </span>
              <div style="margin-top: var(--space-md);">
                <a href="#" class="typo-btn-primary" style="padding: 8px 16px; font-size: 0.85rem;">Voir PDF</a>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Pagination -->
    <div style="margin-top: var(--space-xl);">
      <%= render 'shared/pagination', 
        current_page: 1, 
        total_pages: 7, 
        total_count: 98, 
        per_page: 15,
        path: my_contracts_path %>
    </div>
  </div>
</div>
